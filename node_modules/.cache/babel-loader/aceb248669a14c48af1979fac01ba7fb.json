{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useState}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import{deletePet,getOne}from\"../../services/petService\";import{PetContext}from\"../../context/PetContext\";import{AuthContext}from\"../../context/AuthContext\";import styles from\"../Pets/PetDetails.module.css\";// import styled from \"styled-components\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PetDetails=function PetDetails(){var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var _useParams=useParams(),petId=_useParams.petId;var navigate=useNavigate();var _useContext2=useContext(PetContext),likePet=_useContext2.likePet,unLikePet=_useContext2.unLikePet,removePet=_useContext2.removePet;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),pet=_useState2[0],setPet=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),isLiked=_useState4[0],setIsLiked=_useState4[1];var isOwner=pet.ownerId===(currentUser===null||currentUser===void 0?void 0:currentUser.uid);useEffect(function(){function fetchPet(){return _fetchPet.apply(this,arguments);}function _fetchPet(){_fetchPet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _pet;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getOne(petId);case 3:_pet=_context.sent;setPet(_objectSpread({id:_pet.id},_pet.data()));setIsLiked(_pet.data().likedBy.includes(currentUser===null||currentUser===void 0?void 0:currentUser.uid));_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);navigate(\"/pets\");case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return _fetchPet.apply(this,arguments);}fetchPet();},[petId,currentUser===null||currentUser===void 0?void 0:currentUser.uid,navigate]);var handleEdit=function handleEdit(e){e.preventDefault();navigate(\"/pets/\".concat(petId,\"/edit\"),{state:_objectSpread(_objectSpread({},pet),{},{id:petId})});};var handleLike=function handleLike(e){e.preventDefault();var likeAction=isLiked?unLikePet:likePet;setIsLiked(!isLiked);likeAction(pet,currentUser.uid);};var handleDelete=function handleDelete(e){e.preventDefault();deletePet(petId);removePet(petId);navigate(\"/pets\");};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:styles.details,children:[/*#__PURE__*/_jsx(\"div\",{className:styles[\"img-holder\"],children:/*#__PURE__*/_jsx(\"img\",{src:pet.imageUrl,alt:pet.name})}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"description\"],children:[/*#__PURE__*/_jsx(\"h4\",{className:styles[\"card-title\"],children:pet.name}),/*#__PURE__*/_jsx(\"p\",{className:styles[\"desc-paragraph\"],children:pet.description}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"btn-holder\"],children:[currentUser&&!isOwner&&/*#__PURE__*/_jsx(\"button\",{className:styles[\"desc-btn\"],onClick:handleLike,children:isLiked?\"Liked\":\"Like\"}),isOwner&&/*#__PURE__*/_jsxs(\"button\",{className:styles[\"desc-btn\"],onClick:handleEdit,children:[\"Edit\",\" \"]}),isOwner&&/*#__PURE__*/_jsx(\"button\",{className:styles[\"desc-btn-red\"],onClick:handleDelete,children:\"Delete\"})]})]})]})});};export default PetDetails;","map":{"version":3,"names":["useContext","useEffect","useState","useNavigate","useParams","deletePet","getOne","PetContext","AuthContext","styles","PetDetails","currentUser","petId","navigate","likePet","unLikePet","removePet","pet","setPet","isLiked","setIsLiked","isOwner","ownerId","uid","fetchPet","id","data","likedBy","includes","console","log","handleEdit","e","preventDefault","state","handleLike","likeAction","handleDelete","details","imageUrl","name","description"],"sources":["/Users/ihsuanhuang/Documents/m3hw/petest/petlove/src/components/Pets/PetDetails.js"],"sourcesContent":["\nimport { useContext, useEffect, useState } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { deletePet, getOne } from \"../../services/petService\";\nimport { PetContext } from \"../../context/PetContext\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport styles from \"../Pets/PetDetails.module.css\";\n// import styled from \"styled-components\";\n\nconst PetDetails = () => {\n  const { currentUser } = useContext(AuthContext);\n  const { petId } = useParams();\n  const navigate = useNavigate();\n  const { likePet, unLikePet, removePet } = useContext(PetContext);\n  const [pet, setPet] = useState({});\n  const [isLiked, setIsLiked] = useState(null);\n  const isOwner = pet.ownerId === currentUser?.uid;\n\n  useEffect(() => {\n    async function fetchPet() {\n      try {\n        const pet = await getOne(petId);\n        setPet({ id: pet.id, ...pet.data() });\n        setIsLiked(pet.data().likedBy.includes(currentUser?.uid));\n      } catch (error) {\n        console.log(error);\n        navigate(\"/pets\");\n      }\n    }\n    fetchPet();\n  }, [petId, currentUser?.uid, navigate]);\n\n  const handleEdit = (e) => {\n    e.preventDefault();\n    navigate(`/pets/${petId}/edit`, {\n      state: { ...pet, id: petId },\n    });\n  };\n\n  const handleLike = (e) => {\n    e.preventDefault();\n    const likeAction = isLiked ? unLikePet : likePet;\n    setIsLiked(!isLiked);\n    likeAction(pet, currentUser.uid);\n  };\n\n  const handleDelete = (e) => {\n    e.preventDefault();\n    deletePet(petId);\n    removePet(petId);\n    navigate(\"/pets\");\n  };\n\n  return (\n    <div className=\"container\">\n      <div className={styles.details}>\n        <div className={styles[\"img-holder\"]}>\n          <img src={pet.imageUrl} alt={pet.name} />\n        </div>\n        <div className={styles[\"description\"]}>\n          <h4 className={styles[\"card-title\"]}>{pet.name}</h4>\n          <p className={styles[\"desc-paragraph\"]}>{pet.description}</p>\n          <div className={styles[\"btn-holder\"]}>\n            {currentUser && !isOwner && (\n              <button className={styles[\"desc-btn\"]} onClick={handleLike}>\n                {isLiked ? \"Liked\" : \"Like\"}\n              </button>\n            )}\n            {isOwner && (\n              <button className={styles[\"desc-btn\"]} onClick={handleEdit}>\n                Edit{\" \"}\n              </button>\n            )}\n            {isOwner && (\n              <button className={styles[\"desc-btn-red\"]} onClick={handleDelete}>\n                Delete\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n\nexport default PetDetails;"],"mappings":"uiBACA,OAASA,UAAT,CAAqBC,SAArB,CAAgCC,QAAhC,KAAgD,OAAhD,CACA,OAASC,WAAT,CAAsBC,SAAtB,KAAuC,kBAAvC,CACA,OAASC,SAAT,CAAoBC,MAApB,KAAkC,2BAAlC,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,OAASC,WAAT,KAA4B,2BAA5B,CACA,MAAOC,OAAP,KAAmB,+BAAnB,CACA;wFAEA,GAAMC,WAAU,CAAG,QAAbA,WAAa,EAAM,CACvB,gBAAwBV,UAAU,CAACQ,WAAD,CAAlC,CAAQG,WAAR,aAAQA,WAAR,CACA,eAAkBP,SAAS,EAA3B,CAAQQ,KAAR,YAAQA,KAAR,CACA,GAAMC,SAAQ,CAAGV,WAAW,EAA5B,CACA,iBAA0CH,UAAU,CAACO,UAAD,CAApD,CAAQO,OAAR,cAAQA,OAAR,CAAiBC,SAAjB,cAAiBA,SAAjB,CAA4BC,SAA5B,cAA4BA,SAA5B,CACA,cAAsBd,QAAQ,CAAC,EAAD,CAA9B,wCAAOe,GAAP,eAAYC,MAAZ,eACA,eAA8BhB,QAAQ,CAAC,IAAD,CAAtC,yCAAOiB,OAAP,eAAgBC,UAAhB,eACA,GAAMC,QAAO,CAAGJ,GAAG,CAACK,OAAJ,IAAgBX,WAAhB,SAAgBA,WAAhB,iBAAgBA,WAAW,CAAEY,GAA7B,CAAhB,CAEAtB,SAAS,CAAC,UAAM,SACCuB,SADD,oIACd,oLAEsBlB,OAAM,CAACM,KAAD,CAF5B,QAEUK,IAFV,eAGIC,MAAM,gBAAGO,EAAE,CAAER,IAAG,CAACQ,EAAX,EAAkBR,IAAG,CAACS,IAAJ,EAAlB,EAAN,CACAN,UAAU,CAACH,IAAG,CAACS,IAAJ,GAAWC,OAAX,CAAmBC,QAAnB,CAA4BjB,WAA5B,SAA4BA,WAA5B,iBAA4BA,WAAW,CAAEY,GAAzC,CAAD,CAAV,CAJJ,+EAMIM,OAAO,CAACC,GAAR,cACAjB,QAAQ,CAAC,OAAD,CAAR,CAPJ,oEADc,2CAWdW,QAAQ,GACT,CAZQ,CAYN,CAACZ,KAAD,CAAQD,WAAR,SAAQA,WAAR,iBAAQA,WAAW,CAAEY,GAArB,CAA0BV,QAA1B,CAZM,CAAT,CAcA,GAAMkB,WAAU,CAAG,QAAbA,WAAa,CAACC,CAAD,CAAO,CACxBA,CAAC,CAACC,cAAF,GACApB,QAAQ,iBAAUD,KAAV,UAAwB,CAC9BsB,KAAK,gCAAOjB,GAAP,MAAYQ,EAAE,CAAEb,KAAhB,EADyB,CAAxB,CAAR,CAGD,CALD,CAOA,GAAMuB,WAAU,CAAG,QAAbA,WAAa,CAACH,CAAD,CAAO,CACxBA,CAAC,CAACC,cAAF,GACA,GAAMG,WAAU,CAAGjB,OAAO,CAAGJ,SAAH,CAAeD,OAAzC,CACAM,UAAU,CAAC,CAACD,OAAF,CAAV,CACAiB,UAAU,CAACnB,GAAD,CAAMN,WAAW,CAACY,GAAlB,CAAV,CACD,CALD,CAOA,GAAMc,aAAY,CAAG,QAAfA,aAAe,CAACL,CAAD,CAAO,CAC1BA,CAAC,CAACC,cAAF,GACA5B,SAAS,CAACO,KAAD,CAAT,CACAI,SAAS,CAACJ,KAAD,CAAT,CACAC,QAAQ,CAAC,OAAD,CAAR,CACD,CALD,CAOA,mBACE,YAAK,SAAS,CAAC,WAAf,uBACE,aAAK,SAAS,CAAEJ,MAAM,CAAC6B,OAAvB,wBACE,YAAK,SAAS,CAAE7B,MAAM,CAAC,YAAD,CAAtB,uBACE,YAAK,GAAG,CAAEQ,GAAG,CAACsB,QAAd,CAAwB,GAAG,CAAEtB,GAAG,CAACuB,IAAjC,EADF,EADF,cAIE,aAAK,SAAS,CAAE/B,MAAM,CAAC,aAAD,CAAtB,wBACE,WAAI,SAAS,CAAEA,MAAM,CAAC,YAAD,CAArB,UAAsCQ,GAAG,CAACuB,IAA1C,EADF,cAEE,UAAG,SAAS,CAAE/B,MAAM,CAAC,gBAAD,CAApB,UAAyCQ,GAAG,CAACwB,WAA7C,EAFF,cAGE,aAAK,SAAS,CAAEhC,MAAM,CAAC,YAAD,CAAtB,WACGE,WAAW,EAAI,CAACU,OAAhB,eACC,eAAQ,SAAS,CAAEZ,MAAM,CAAC,UAAD,CAAzB,CAAuC,OAAO,CAAE0B,UAAhD,UACGhB,OAAO,CAAG,OAAH,CAAa,MADvB,EAFJ,CAMGE,OAAO,eACN,gBAAQ,SAAS,CAAEZ,MAAM,CAAC,UAAD,CAAzB,CAAuC,OAAO,CAAEsB,UAAhD,kBACO,GADP,GAPJ,CAWGV,OAAO,eACN,eAAQ,SAAS,CAAEZ,MAAM,CAAC,cAAD,CAAzB,CAA2C,OAAO,CAAE4B,YAApD,oBAZJ,GAHF,GAJF,GADF,EADF,CA8BD,CA1ED,CA6EA,cAAe3B,WAAf"},"metadata":{},"sourceType":"module"}