{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/ihsuanhuang/Documents/m3hw/petest/petlove/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useState}from'react';import{useNavigate,useParams}from'react-router-dom';import{deletePet,getOne}from'../../services/petService';import{PetContext}from'../../context/PetContext';import{AuthContext}from'../../context/AuthContext';import styles from'../Pets/PetDetails.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PetDetails=function PetDetails(){var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var ctx=useContext(PetContext);var _useState=useState({}),_useState2=_slicedToArray(_useState,2),pet=_useState2[0],setPet=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),isLiked=_useState4[0],setIsLiked=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),confirmDelete=_useState6[0],setConfirmDelete=_useState6[1];var _useParams=useParams(),petId=_useParams.petId;var navigate=useNavigate();var isOwner=pet.ownerId===(currentUser===null||currentUser===void 0?void 0:currentUser.uid);useEffect(function(){getOne(petId).then(function(pet){setPet(_objectSpread({id:pet.id},pet.data()));if(!pet.data().likedBy.includes(currentUser===null||currentUser===void 0?void 0:currentUser.uid)){setIsLiked(false);}else{setIsLiked(true);}}).catch(function(error){console.log(error);navigate('/pets');});},[ctx,petId,isLiked,currentUser===null||currentUser===void 0?void 0:currentUser.uid]);var editHandler=function editHandler(e){e.preventDefault();navigate(\"/pets/\".concat(petId,\"/edit\"),{state:_objectSpread(_objectSpread({},pet),{},{id:petId})});};var likeHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(isLiked){setIsLiked(false);ctx.unLikePet(pet,currentUser.uid);}else{setIsLiked(true);ctx.likePet(pet,currentUser.uid);}case 2:case\"end\":return _context.stop();}}},_callee);}));return function likeHandler(_x){return _ref.apply(this,arguments);};}();var deleteHandler=function deleteHandler(e){e.preventDefault();deletePet(petId);ctx.removePet(petId);navigate('/pets');};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:styles[\"details\"],children:[/*#__PURE__*/_jsx(\"div\",{className:styles[\"img-holder\"],children:/*#__PURE__*/_jsx(\"img\",{src:pet.imageUrl,alt:pet.name})}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"description\"],children:[/*#__PURE__*/_jsx(\"h4\",{className:styles[\"card-title\"],children:pet.name}),/*#__PURE__*/_jsx(\"p\",{className:styles[\"desc-paragraph\"],children:pet.description}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"btn-holder\"],children:[currentUser&&!isOwner&&/*#__PURE__*/_jsx(\"button\",{className:styles[\"desc-btn\"],onClick:likeHandler,children:isLiked?\"Liked\":\"Like\"}),isOwner&&/*#__PURE__*/_jsxs(\"button\",{className:styles[\"desc-btn\"],onClick:editHandler,children:[\"Edit\",\" \"]}),isOwner&&/*#__PURE__*/_jsx(\"button\",{className:styles[\"desc-btn-red\"],onClick:deleteHandler,children:\"Delete\"})]})]})]})});};export default PetDetails;","map":{"version":3,"names":["useContext","useEffect","useState","useNavigate","useParams","deletePet","getOne","PetContext","AuthContext","styles","PetDetails","currentUser","ctx","pet","setPet","isLiked","setIsLiked","confirmDelete","setConfirmDelete","petId","navigate","isOwner","ownerId","uid","then","id","data","likedBy","includes","catch","error","console","log","editHandler","e","preventDefault","state","likeHandler","unLikePet","likePet","deleteHandler","removePet","imageUrl","name","description"],"sources":["/Users/ihsuanhuang/Documents/m3hw/petest/petlove/src/components/Pets/PetDetails.js"],"sourcesContent":["import { useContext, useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\n\nimport { deletePet, getOne } from '../../services/petService';\n\nimport { PetContext } from '../../context/PetContext';\nimport { AuthContext } from '../../context/AuthContext';\nimport styles from '../Pets/PetDetails.module.css';\n\n\nconst PetDetails = () => {\n    const { currentUser } = useContext(AuthContext);\n    const ctx = useContext(PetContext);\n\n    const [pet, setPet] = useState({});\n    const [isLiked, setIsLiked] = useState(null);\n    const [confirmDelete, setConfirmDelete] = useState(false);\n\n    const { petId } = useParams();\n\n    const navigate = useNavigate();\n\n\n    const isOwner = pet.ownerId === currentUser?.uid;\n\n\n    useEffect(() => {\n\n        getOne(petId).then((pet) => {\n\n            setPet({ id: pet.id, ...pet.data() });\n\n            if (!pet.data().likedBy.includes(currentUser?.uid)) {\n                setIsLiked(false);\n            } else {\n                setIsLiked(true);\n            }\n\n        }).catch((error) => {\n            console.log(error)\n            navigate('/pets')\n        })\n\n\n    }, [ctx, petId, isLiked, currentUser?.uid]);\n\n\n    const editHandler = (e) => {\n        e.preventDefault();\n\n        navigate(`/pets/${petId}/edit`, {\n            state: { ...pet, id: petId }\n        }\n        )\n    }\n    const likeHandler = async (e) => {\n        e.preventDefault();\n\n        if (isLiked) {\n            setIsLiked(false);\n            ctx.unLikePet(pet, currentUser.uid);\n        } else {\n            setIsLiked(true);\n            ctx.likePet(pet, currentUser.uid);\n        }\n    }\n\n    const deleteHandler = (e) => {\n        e.preventDefault();\n\n        deletePet(petId);\n        ctx.removePet(petId);\n        navigate('/pets')\n    }\n\n\n\n\n\n    return (\n\n        <div className=\"container\">\n            <div className={styles[\"details\"]}>\n                <div className={styles[\"img-holder\"]}>\n                    <img src={pet.imageUrl} alt={pet.name} />\n                </div>\n                <div className={styles[\"description\"]}>\n                    <h4 className={styles[\"card-title\"]}>{pet.name}</h4>\n                    <p className={styles[\"desc-paragraph\"]}>{pet.description}</p>\n                    <div className={styles[\"btn-holder\"]}>\n                        {currentUser && !isOwner && (\n                            <button className={styles[\"desc-btn\"]} onClick={likeHandler}>\n                                {isLiked ? \"Liked\" : \"Like\"}\n                            </button>\n                        )}\n                        {isOwner && (\n                            <button className={styles[\"desc-btn\"]} onClick={editHandler}>\n                                Edit{\" \"}\n                            </button>\n                        )}\n                        {isOwner && (\n                            <button className={styles[\"desc-btn-red\"]} onClick={deleteHandler}>\n                                Delete\n                            </button>\n                        )}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n\n}\n\n\nexport default PetDetails;"],"mappings":"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"},"metadata":{},"sourceType":"module"}